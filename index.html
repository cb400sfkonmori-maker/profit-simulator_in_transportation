<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>運輸業利益再設計シミュレーター | Art mix</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; -webkit-tap-highlight-color: transparent; }
        .gradient-bg { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); }
        input[type="range"]::-webkit-slider-thumb {
            width: 26px; height: 26px; background: #2563eb; cursor: pointer; border-radius: 50%; border: 4px solid white; box-shadow: 0 4px 6px rgba(0,0,0,0.2); -webkit-appearance: none;
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-900 pb-20">

    <header class="gradient-bg text-white py-12 px-6 text-center shadow-2xl mb-8">
        <h1 class="text-3xl font-bold mb-3 tracking-tight">運輸業・利益再設計シミュレーター</h1>
        <p class="text-slate-400 text-sm max-w-lg mx-auto leading-relaxed">
            市場価格を捉え、保守設計で経営を守る。現場の「劣化」を数字に変える診断ツール。
        </p>
    </header>

    <main class="max-w-xl mx-auto px-4">
        
        <div id="capture-area" class="bg-slate-100 p-2 rounded-[2rem]">
            
            <div class="sticky top-4 z-20 mb-8 bg-white/95 backdrop-blur-lg p-8 rounded-[2.5rem] shadow-2xl border border-blue-100 text-center">
                <p class="text-[10px] font-bold text-slate-400 mb-2 uppercase tracking-[0.2em]">年間想定利益損失額</p>
                <div class="text-5xl font-extrabold text-red-600 mb-4 leading-none py-2">
                    ¥ <span id="total-loss">0</span>
                </div>
                
                <div class="flex gap-3 mt-4">
                    <button onclick="saveAsImage()" class="flex-1 bg-slate-800 text-white text-[10px] font-bold py-4 px-2 rounded-2xl hover:bg-slate-700 active:scale-95 transition-all flex items-center justify-center shadow-lg">
                        画像として保存
                    </button>
                    <button onclick="shareOnLine()" class="flex-1 bg-[#06C755] text-white text-[10px] font-bold py-4 px-2 rounded-2xl hover:opacity-90 active:scale-95 transition-all flex items-center justify-center shadow-lg">
                        LINEで送る
                    </button>
                </div>
            </div>

            <div class="space-y-10 bg-white p-8 rounded-[2rem] shadow-sm border border-slate-200">
                
                <div>
                    <div class="flex justify-between items-end mb-5">
                        <label class="font-bold text-slate-700 flex flex-col">
                            <span>軽油単価（計算基準）</span>
                            <span class="text-[10px] text-slate-400 font-normal">市場平均：約143円 / 保守設計：160円</span>
                        </label>
                        <span class="text-2xl font-black text-red-600"><span id="val-price">160</span><small class="text-xs text-slate-400 ml-1">円/L</small></span>
                    </div>
                    <input type="range" id="input-price" min="100" max="200" value="160" step="1" class="w-full h-2 bg-slate-100 rounded-lg appearance-none cursor-pointer accent-red-600">
                </div>

                <div>
                    <div class="flex justify-between items-center mb-5">
                        <label class="font-bold text-slate-700 flex items-center">保有車両数</label>
                        <span class="text-2xl font-black text-blue-600"><span id="val-vehicles">45</span><small class="text-xs text-slate-400 ml-1">台</small></span>
                    </div>
                    <input type="range" id="input-vehicles" min="10" max="100" value="45" step="1" class="w-full h-2 bg-slate-100 rounded-lg appearance-none cursor-pointer">
                </div>

                <div>
                    <div class="flex justify-between items-center mb-5">
                        <label class="font-bold text-slate-700 flex items-center">年間走行距離/台</label>
                        <span class="text-2xl font-black text-blue-600"><span id="val-mileage">60,000</span><small class="text-xs text-slate-400 ml-1">km</small></span>
                    </div>
                    <input type="range" id="input-mileage" min="10000" max="150000" value="60000" step="5000" class="w-full h-2 bg-slate-100 rounded-lg appearance-none cursor-pointer">
                </div>

                <div>
                    <div class="flex justify-between items-center mb-5">
                        <label class="font-bold text-slate-700 flex items-center">平均待機時間</label>
                        <span class="text-2xl font-black text-blue-600"><span id="val-wait">1.0</span><small class="text-xs text-slate-400 ml-1">h/日</small></span>
                    </div>
                    <input type="range" id="input-wait" min="0" max="5.0" value="1.0" step="0.5" class="w-full h-2 bg-slate-100 rounded-lg appearance-none cursor-pointer">
                </div>

                <div>
                    <div class="flex justify-between items-center mb-5">
                        <label class="font-bold text-slate-700 flex items-center text-blue-600">燃費改善の余地</label>
                        <span class="text-2xl font-black text-blue-600"><span id="val-fuel">0.3</span><small class="text-xs text-slate-400 ml-1">km/L</small></span>
                    </div>
                    <input type="range" id="input-fuel" min="0" max="1.5" value="0.3" step="0.1" class="w-full h-2 bg-slate-100 rounded-lg appearance-none cursor-pointer">
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-[10px] font-bold text-slate-400 mb-2 uppercase">事故/トラブル</label>
                        <input type="range" id="input-accidents" min="0" max="30" value="3" step="1" class="w-full h-1.5 bg-slate-100 rounded-lg appearance-none cursor-pointer">
                        <div class="text-right mt-1 text-slate-600 font-bold"><span id="val-accidents">3</span><small class="text-[10px] ml-1">件</small></div>
                    </div>
                    <div>
                        <label class="block text-[10px] font-bold text-slate-400 mb-2 uppercase">年間離職人数</label>
                        <input type="range" id="input-turnover" min="0" max="20" value="2" step="1" class="w-full h-1.5 bg-slate-100 rounded-lg appearance-none cursor-pointer">
                        <div class="text-right mt-1 text-slate-600 font-bold"><span id="val-turnover">2</span><small class="text-[10px] ml-1">名</small></div>
                    </div>
                </div>

            </div>

            <div class="mt-8 bg-slate-800 text-slate-300 p-8 rounded-[2rem] shadow-inner text-[11px] leading-relaxed">
                <h4 class="text-xs font-bold text-blue-400 mb-5 uppercase tracking-widest flex items-center">
                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    設計根拠とロジック
                </h4>
                <div class="space-y-4 font-mono opacity-90">
                    <div>
                        <span class="text-white font-bold block mb-1">⛽ 燃料損失：</span>
                        設定単価 <span id="logic-price" class="text-red-400 text-sm">160</span>円/L 基準。<br>
                        式: ((走行距離/3.5) - (走行距離/(3.5+改善余地))) × 単価 × 台数
                    </div>
                    <div>
                        <span class="text-white font-bold block mb-1">⏳ 待機損失：</span>
                        時間単価2,500円（人件費＋車両減価償却費）, 稼働260日/年
                    </div>
                    <div>
                        <span class="text-white font-bold block mb-1">⚠️ 品質/人財損失：</span>
                        事故1件：300,000円（実損＋管理工数）<br>
                        離職1名：1,200,000円（採用費＋教育費＋機会損失）
                    </div>
                </div>
            </div>
        </div>

        <footer class="mt-16 text-center text-slate-400 text-[10px] space-y-1">
            <p>&copy; 2026 Art mix Inc. | Designed by Junya Komori</p>
            <p>「未来を動かすハンドルと、どこへでも行ける地図を。」</p>
        </footer>
    </main>

    <script>
        const inputIds = ['price', 'vehicles', 'mileage', 'wait', 'fuel', 'accidents', 'turnover'];
        const elements = {};
        inputIds.forEach(id => {
            elements[id] = document.getElementById(`input-${id}`);
            elements[`val-${id}`] = document.getElementById(`val-${id}`);
        });

        function calculate() {
            const p = parseFloat(elements.price.value);
            const n = parseFloat(elements.vehicles.value);
            const m = parseFloat(elements.mileage.value);
            const h = parseFloat(elements.wait.value);
            const fGap = parseFloat(elements.fuel.value);
            const acc = parseFloat(elements.accidents.value);
            const turn = parseFloat(elements.turnover.value);

            const wLoss = h * 2500 * 260 * n;
            const fLoss = ((m / 3.5) - (m / (3.5 + fGap))) * p * n;
            const qLoss = acc * 300000;
            const rLoss = turn * 1200000;
            const total = wLoss + fLoss + qLoss + rLoss;

            // UI更新
            inputIds.forEach(id => {
                let v = elements[id].value;
                if (id === 'mileage') elements[`val-${id}`].innerText = parseFloat(v).toLocaleString();
                else if (id === 'wait' || id === 'fuel') elements[`val-${id}`].innerText = parseFloat(v).toFixed(1);
                else elements[`val-${id}`].innerText = v;
            });
            document.getElementById('logic-price').innerText = p;
            document.getElementById('total-loss').innerText = Math.floor(total).toLocaleString();
        }

        function saveAsImage() {
            const area = document.getElementById('capture-area');
            html2canvas(area, { scale: 2, backgroundColor: "#f1f5f9" }).then(canvas => {
                const link = document.createElement('a');
                link.download = '利益再設計診断結果.png';
                link.href = canvas.toDataURL();
                link.click();
            });
        }

        function shareOnLine() {
            const total = document.getElementById('total-loss').innerText;
            const price = elements.price.value;
            const text = `【利益再設計診断】軽油単価${price}円設定での年間想定損失額：¥${total}。この損失を「設計」で利益に変えませんか？ 詳細は小森まで。`;
            window.location.href = `https://line.me/R/msg/text/?${encodeURIComponent(text)}`;
        }

        inputIds.forEach(id => elements[id].addEventListener('input', calculate));
        
        // 初回計算
        calculate();
    </script>
</body>
</html>
